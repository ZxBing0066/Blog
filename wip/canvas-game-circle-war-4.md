# 从 0 手撸 canvas 小游戏：圆圆战争 - 帧率计算、垃圾回收篇

上篇我们为圆圆战争增加了敌人随机生成、帧率计算、垃圾回收等。本篇我们会为游戏增加关卡、分数计算、输赢判断等逻辑，让游戏变得更完整。

先看下本章最后的成果：

## 关卡

首先关卡我们需要定义的数据包括敌人出现的时机、数量、强度，还需要制作关卡切换。

```ts
const stages = [
    {
        enemies: [10, 20, 30]
    },
    {
        enemies: [15, 25, 40]
    },
    {
        enemies: [20, 30, 50]
    }
];
```

每个对象代表一个关卡，而 enemies 数组代表敌人的数量。当我们消灭一组敌人时，便会开始生成下一组敌人，全部消灭则进入下一关卡。

## 分数计算

为了方便扩展，我们直接将分数放在 Enemy 类中，这样在敌人被消灭时，我们取出敌人的分数进行添加即可。

```ts

```

## 输赢判断

输及敌人将圆王消灭的场景，此处我们需要添加上敌人伤害圆王的逻辑。赢则是我们坚持到所有敌人消灭且没有后续场景的逻辑

## 结语
